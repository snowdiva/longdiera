webpackJsonp([15,22],{219:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{showCover:!1,imgUrl:"",defaultList:[],cover_header:{Authorization:""},formItem:{title:"",chinese_title:"",intro:"",sort_id:0,rate:5,author:"",cover_ext:"",cover_name:"",publish_status:0},sort_list:[],ruleFormItem:{title:[{required:!0,message:"英文名称不能为空",trigger:"blur"},{type:"string",max:100,message:"书名太长了",trigger:"blur"}],chinese_title:[{required:!0,message:"中文名称不能为空",trigger:"blur"},{type:"string",max:50,message:"书名太长了",trigger:"blur"}],intro:[{type:"string",max:500,message:"简介不能超过500个字符",trigger:"blur"}],author:[{type:"string",max:50,message:"作者名称太长",trigger:"blur"}]}}},created:function(){this.initList(),this.cover_header.Authorization=sessionStorage.getItem("access_token",null)},methods:{routeTo:function(t){return this.$router.push(t)},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t?e.$http.post("/admin_api/novel/edit",e.formItem).then(function(t){0===t.body.error?(e.$Message.success(t.body.message),e.$router.push("/novel")):e.$Notice.error({title:"错误编号:"+t.error,desc:t.message})}):e.$Notice.error({title:"提交的数据有误",desc:"你是不是对提交的信息做手脚了?!"})})},handleView:function(t){this.imgUrl=t,this.showCover=!0},handleRemove:function(){this.defaultList=[],this.formItem.cover_ext=""},handleSuccess:function(t){this.defaultList.push(t.data),this.formItem.cover_ext=this.defaultList[0].cover_ext,this.formItem.cover_name=this.defaultList[0].name,this.defaultList[0].status="finished"},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。"})},handleMaxSize:function(t){this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+t.name+" 太大，不能超过 2M。"})},handleBeforeUpload:function(){var t=this.defaultList.length<1;return t||this.$Notice.warning({title:"最多只能上传 1 张图片。"}),t},initList:function(){var t=this,e=this.$route.query.id||"";if(""===e)return this.$Notice.error({title:"页面初始化失败",desc:"缺少必要的文章编号"}),this.$router.push("/novel");this.$http.post("/admin_api/novel/edit",{get:"one",id:e}).then(function(e){0===e.body.error?(t.formItem=e.body.data.novel,t.sort_list=e.body.data.sort_list,""!==e.body.data.novel.cover_url&&t.defaultList.push({name:e.body.data.novel.id,url:e.body.data.novel.cover_url,status:"finished"})):t.$Notice.error({title:"初始化数据失败",desc:e.body.message})})}}}},235:function(t,e,o){e=t.exports=o(15)(),e.push([t.i,".demo-upload-list{display:inline-block;width:90px;height:120px;text-align:center;line-height:120px;border:1px solid transparent;border-radius:4px;overflow:hidden;background:#fff;position:relative;box-shadow:0 1px 1px rgba(0,0,0,.2);margin-right:4px}.demo-upload-list img{width:100%;height:100%}.demo-upload-list-cover{display:none;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.6)}.demo-upload-list:hover .demo-upload-list-cover{display:block}.demo-upload-list-cover i{color:#fff;font-size:20px;cursor:pointer;margin:0 2px}","",{version:3,sources:["/Users/snowdiva/www/font/ldemanage/src/components/pages/NovelEdit.vue"],names:[],mappings:"AACA,kBACE,qBAAsB,AACtB,WAAY,AACZ,aAAc,AACd,kBAAmB,AACnB,kBAAmB,AACnB,6BAA8B,AAC9B,kBAAmB,AACnB,gBAAiB,AACjB,gBAAiB,AACjB,kBAAmB,AACnB,oCAAqC,AACrC,gBAAkB,CACnB,AACD,sBACE,WAAY,AACZ,WAAa,CACd,AACD,wBACE,aAAc,AACd,kBAAmB,AACnB,MAAO,AACP,SAAU,AACV,OAAQ,AACR,QAAS,AACT,yBAA2B,CAC5B,AACD,gDACE,aAAe,CAChB,AACD,0BACE,WAAY,AACZ,eAAgB,AAChB,eAAgB,AAChB,YAAc,CACf",file:"NovelEdit.vue",sourcesContent:["\n.demo-upload-list{\n  display: inline-block;\n  width: 90px;\n  height: 120px;\n  text-align: center;\n  line-height: 120px;\n  border: 1px solid transparent;\n  border-radius: 4px;\n  overflow: hidden;\n  background: #fff;\n  position: relative;\n  box-shadow: 0 1px 1px rgba(0,0,0,.2);\n  margin-right: 4px;\n}\n.demo-upload-list img{\n  width: 100%;\n  height: 100%;\n}\n.demo-upload-list-cover{\n  display: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0,0,0,.6);\n}\n.demo-upload-list:hover .demo-upload-list-cover{\n  display: block;\n}\n.demo-upload-list-cover i{\n  color: #fff;\n  font-size: 20px;\n  cursor: pointer;\n  margin: 0 2px;\n}\n"],sourceRoot:""}])},257:function(t,e,o){var r=o(235);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);o(16)("0f2c16f6",r,!0)},283:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"novel-details"}},[o("div",{staticClass:"breadcrumb-box"},[o("Breadcrumb",[o("Breadcrumb-item",{attrs:{href:"javascript:;"},nativeOn:{click:function(e){t.routeTo("/home")}}},[t._v(" 首页 ")]),t._v(" "),o("Breadcrumb-item",{attrs:{href:"javascript:;"},nativeOn:{click:function(e){t.routeTo("/novel")}}},[t._v(" 小说管理 ")]),t._v(" "),o("Breadcrumb-item",[t._v(" 编辑小说 ")])],1)],1),t._v(" "),o("Row",[o("Card",{staticClass:"table-box"},[o("h2",{staticStyle:{"text-align":"left"}},[t._v("编辑小说")]),t._v(" "),o("hr"),t._v(" "),o("br"),t._v(" "),o("i-form",{ref:"formItem",attrs:{model:t.formItem,"label-width":100,rules:t.ruleFormItem}},[o("Form-item",{attrs:{label:"书名(英文)",prop:"title"}},[o("i-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入英文名称..."},model:{value:t.formItem.title,callback:function(e){t.formItem.title=e},expression:"formItem.title"}})],1),t._v(" "),o("Form-item",{attrs:{label:"书名(中文)",prop:"chinese_title"}},[o("i-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入中文名称..."},model:{value:t.formItem.chinese_title,callback:function(e){t.formItem.chinese_title=e},expression:"formItem.chinese_title"}})],1),t._v(" "),o("Form-item",{attrs:{label:"简介",prop:"intro"}},[o("i-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"简介内容将在首页部分地方显示..."},model:{value:t.formItem.intro,callback:function(e){t.formItem.intro=e},expression:"formItem.intro"}})],1),t._v(" "),o("Form-item",{attrs:{label:"分类标签",prop:"sort_id"}},[o("Select",{staticStyle:{width:"300px"},attrs:{placeholder:"选择分类"},model:{value:t.formItem.sort_id,callback:function(e){t.formItem.sort_id=e},expression:"formItem.sort_id"}},t._l(t.sort_list,function(e){return o("Option",{attrs:{value:e.id}},[t._v(t._s(e.chinese_name))])}))],1),t._v(" "),o("Form-item",{attrs:{label:"作者",prop:"author"}},[o("i-input",{staticStyle:{width:"200px"},attrs:{placeholder:"不填写默认为unknown"},model:{value:t.formItem.author,callback:function(e){t.formItem.author=e},expression:"formItem.author"}})],1),t._v(" "),o("Form-item",{attrs:{label:"发布状态",prop:"publish_status"}},[o("Radio-group",{attrs:{type:"button"},model:{value:t.formItem.publish_status,callback:function(e){t.formItem.publish_status=e},expression:"formItem.publish_status"}},[o("Radio",{attrs:{label:"0"}},[t._v("连载中")]),t._v(" "),o("Radio",{attrs:{label:"1"}},[t._v("已完结")])],1)],1),t._v(" "),o("Form-item",{attrs:{label:"评级"}},[o("Row",[o("i-col",{attrs:{span:"24"}},[o("Rate",{attrs:{"allow-half":"","show-text":""},model:{value:t.formItem.rate,callback:function(e){t.formItem.rate=e},expression:"formItem.rate"}},[o("span",{staticStyle:{color:"#f5a623"}},[t._v(t._s(t.formItem.rate))])])],1),t._v(" "),o("i-col",{attrs:{span:"6"}},[o("Slider",{attrs:{"show-input":"",max:5,min:1},model:{value:t.formItem.rate,callback:function(e){t.formItem.rate=e},expression:"formItem.rate"}})],1)],1)],1),t._v(" "),o("Form-item",{attrs:{label:"封面",prop:"cover_ext"}},[t._l(t.defaultList,function(e){return o("div",{staticClass:"demo-upload-list"},["finished"===e.status?[o("img",{attrs:{src:e.url}}),t._v(" "),o("div",{staticClass:"demo-upload-list-cover"},[o("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(o){t.handleView(e.url)}}}),t._v(" "),o("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){t.handleRemove(e)}}})],1)]:[e.showProgress?o("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),t._v(" "),o("Upload",{staticStyle:{display:"inline-block",width:"auto"},attrs:{"ref:upload":"","on-success":t.handleSuccess,"show-upload-list":!1,"default-file-list":t.defaultList,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,type:"drag",action:"/admin_api/novel/cover",headers:t.cover_header,name:"cover"}},[o("div",{staticStyle:{width:"90px",height:"120px","line-height":"120px"}},[o("Icon",{attrs:{type:"camera",size:"20"}})],1)]),t._v(" "),o("Modal",{attrs:{title:"查看图片"},model:{value:t.showCover,callback:function(e){t.showCover=e},expression:"showCover"}},[t.showCover?o("img",{staticStyle:{width:"100%"},attrs:{src:t.imgUrl}}):t._e()])],2),t._v(" "),o("Form-item",[o("i-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.handleSubmit("formItem")}}},[t._v(" 提交修改 ")]),t._v(" "),o("i-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"ghost"},nativeOn:{click:function(e){t.routeTo("/novel")}}},[t._v(" 取消返回 ")])],1)],1)],1)],1)],1)},staticRenderFns:[]}},29:function(t,e,o){o(257);var r=o(6)(o(219),o(283),null,null);t.exports=r.exports}});
//# sourceMappingURL=15.322e510f0d23e6692529.js.map